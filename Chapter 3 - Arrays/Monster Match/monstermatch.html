<!DOCTYPE html>
<html>
    <head>
        <title>Monster Match</title>
        <style>
            body
            {
                padding: 15px 0;
                border: 10px double rgb(255, 0, 0);
                text-align: center;
                background: linear-gradient(90deg, rgb(0, 238, 255) 0%, rgb(76, 0, 255) 100%), 
                rgb(0, 26, 255) 44%;
                font-family: Verdana, Geneva, Tahoma, sans-serif;
                color: rgb(1, 37, 0)
            }
            table
            {
                margin-left: auto;
                margin-right: auto;
            }
        </style>
        <script>
            let p1Deck = []
            let p2Deck = []
            let deckIndex1
            let deckIndex2
            let curCardP1
            let curCardP2
            let deckCards = 8
            let imageArray = ["monster1.svg", "monster2.svg", "monster3.svg", "monster4.svg"]
            let gameState = "Game Over"
            let score = 0

            // Description: Return a random integer, n, such that min <= n <= max
            // Citation: Mozilla Foundation
            // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/random
            // Input/Parameters: Two floating point numbers, min and max
            // Output/Return: Returns a random integer between min and max
            function randomInt(min, max) 
            {
                min = Math.ceil(min);
                max = Math.floor(max);
                
                return Math.floor(Math.random() * (max - min + 1)) + min; 
            }
            // Description: Takes a list of images and returns a random one
            // Citations: None
            // Input/Parameters: List of images
            // Output/Return: Random image from the list and displays
            function formatImage(inputArray, index)
            {
                let fileName = inputArray[index];

                let output = "<img src='Monster Pics/" + fileName + " ' width=200 height=300>";
                
                return output;
            }
            // Description: Displays a set of instructions when the button is clicked
            // Citation: None
            // Input/Parameters: The instructions
            // Output/Return: The instructions
            function viewInstructions()
            {
                divIdinstruct.innerHTML = "Full Instructions:" + "<br>" + 
                "Each player has a deck of monster cards. Each round, a " + "<br>" +
                "player will reveal a random card from their deck. If the " + "<br>" +
                "cards match, it is a 'Monster Match.' The fastest player " + "<br>" +
                "can claim the other player's card (it is removed from the " + "<br>" +
                "deck of the slower player's deck and added to the faster " + "<br>" +
                "player's deck). Player 1 can claim a match by pressing 'a' " + "<br>" +
                "before Player 2 can claim the match by pressing 'l'. If a " + "<br>" +
                "player presses 'a' or 'l' when there is not a match, they " + "<br>" +
                "will give up their card. If the cards don't match, press 'n' " + "<br>" +
                "to start the next round, When a player has claimed all the " + "<br>" +
                "other player's cards, the player wins the game."
            }
            // Description: Displays score after every round
            // Citation: None
            // Input/Parameters: The length of each player's deck
            // Output/Return: The number of cards each player has remaining
            function displayScore()
            {
                p1CountId.innerHTML = "Cards Left: " + p1Deck.length;
                p2CountId.innerHTML = "Cards Left: " + p2Deck.length;
            }
            // Description: Picks random index in each player's deck, takes random image using that index and displays
            // Citation: None
            // Input/Parameters: List of images with unique indices
            // Output/Return: Random image in each player's decl
            function dealNewCards()
            {
                deckIndex1 = randomInt(0, p1Deck.length - 1);
                deckIndex2 = randomInt(0, p2Deck.length - 1);
                
                curCardP1 = formatImage(p1Deck, deckIndex1);
                curCardP2 = formatImage(p2Deck, deckIndex2);

                image1Id.innerHTML = curCardP1
                image2Id.innerHTML = curCardP2

                gameState = "Play"

                divIdinstruct.innerHTML = "Player 1 press 'a' if matching. Player 2 press 'l' if matching"
            }
            // Description: Starts a new game when the start new game button is clicked, resets score from previous game
            // Citation: None
            // Input/Parameters: A random index from the image array and pushes it into each player's deck twice
            // Output/Return: Resets the score and deals new cards
            function newGame()
            {
                p1Deck = []
                p2Deck = []

                for (i=0; i<=3; i++)
                {
                    p1Deck.push(imageArray[i])
                    p1Deck.push(imageArray[i])
                    p2Deck.push(imageArray[i])
                    p2Deck.push(imageArray[i])
                }

                player1Id.innerHTML = "Player 1"
                player2Id.innerHTML = "Player 2"

                dealNewCards();
                displayScore();

                divIdmessages.innerHTML = ""
            }
            // Description: Displays winning message once a player steals the other player's cards
            // Citation: None
            // Input/Parameters: Winning message if player 1 wins and vice versa
            // Output/Return: Displays winning message
            function winGame()
            {
                if (p1Deck.length == 0)
                {
                    divIdmessages.innerHTML = "Player 2 has won! Press 'Start New Game' to play again"
                }
                else if (p2Deck.length == 0)
                {
                    divIdmessages.innerHTML = "Player 1 has won! Press 'Start New Game' to play again"
                }
                gameState = "Game Over"
            }
            // Description: Checks if the cards match based on the key pressed then moves a card to the other player based on who won the match
            // Citation: None
            // Input/Parameters: Keys such as 'a', 'l', and 'n'. Checks if the two cards displayed are the same or different. 
            // Output/Return: A message based on who won the match, deals new cards, and changes the score.
            function checkMatch(event)
            {
                pressKey = event.key
                if (gameState == "Play")
                {
                    if (pressKey == "a")
                    {
                        if (curCardP1 == curCardP2)
                        {
                            p1Deck.push(p2Deck[deckIndex2])
                            p2Deck.splice(deckIndex2,1)
                            divIdmessages.innerHTML = "Congrats Player 1 has claimed the match! Press 'n' to deal more cards."
                        }
                        else
                        {
                            p2Deck.push(p1Deck[deckIndex1])
                            p1Deck.splice(deckIndex1,1)
                            divIdmessages.innerHTML = "Player 1 has misfired! Press 'n' to deal more cards."
                        }
                        gameState = "Pause"
                        displayScore();
                        winGame();
                        dealNewCards();
                    }
                    else if (pressKey == "l")
                    {
                        if (curCardP1 == curCardP2)
                        {
                            p2Deck.push(p1Deck[deckIndex1])
                            p1Deck.splice(deckIndex1,1)
                            divIdmessages.innerHTML = "Congrats Player 2 has claimed the match! Press 'n' to deal more cards."
                        }
                        else
                        {
                            p1Deck.push(p2Deck[deckIndex2])
                            p2Deck.splice(deckIndex2,1)
                            divIdmessages.innerHTML = "Player 2 has misfired! Press 'n' to deal more cards."
                        }
                        gameState = "Pause"
                        displayScore();
                        winGame();
                        dealNewCards();
                    }
                    else if (pressKey == "n")
                    {
                        if (curCardP1 == curCardP2)
                        {
                            divIdmessages.innerHTML = "There is a match on the board, someone must claim it!"
                            gameState = "Play"
                        }
                        else 
                        {
                            dealNewCards();
                            gameState = "Play"
                        }
                    }
                    else 
                    {
                        divIdmessages.innerHTML = "Oops, you clicked an invalid key. Player 1 please press 'a' if matching and Player 2 please press 'l' if matching otherwise press 'n' to deal more cards."
                    }
                }
                else if (gameState == "Pause")
                {
                    if (pressKey == "n")
                    {
                        gameState = "Play"
                        dealNewCards();
                    }
                }
            }
        </script>
    </head>
    <body onkeyup="checkMatch(event)">
        <h1>Monster Match</h1>
        <input type="button" value="Start New Game" onClick="newGame()">
        <input type="button" value="View Game Instructions" onClick="viewInstructions()">
        <table>
            <tr>
                <th><span id="player1Id"></span></th>
                <th><span id="player2Id"></span></th>
            </tr>
            <tr>
                <th><span id="image1Id"></span></th>
                <th><span id="image2Id"></span></th>
            </tr>
            <tr>
                <th><span id="p1CountId"></span></th>
                <th><span id="p2CountId"></span></th>
            </tr>
        </table>
        <div id="divIdmessages"></div>
        <div id="divIdinstruct"></div>
        <div id="divIdcurScore"></div>
    </body>
</html>