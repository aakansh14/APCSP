<!DOCTYPE html>
<html>
    <head>
        <title>Monster Match</title>
        <style>
            body
            {
                padding: 15px 0;
                border: 10px double rgb(255, 0, 0);
                text-align: center;
                background: linear-gradient(90deg, rgb(143, 137, 250) 0%, rgb(58, 77, 250) 44%, 
                rgb(76, 0, 255) 100%);
                font-family: Verdana, Geneva, Tahoma, sans-serif;
                color: rgb(1, 37, 0)
            }
            table
            {
                margin-left: auto;
                margin-right: auto;
            }
        </style>
        <script>
            let p1Deck = []
            let p2Deck = []
            let deckIndex1
            let deckIndex2
            let curCardP1
            let curCardP2
            let deckCards = 8
            let imageArray = ["monster1.svg", "monster2.svg", "monster3.svg", "monster4.svg"]
            let gameState = "Game Over"
            let score = 0

            // Description: Return a random integer, n, such that min <= n <= max
            // Citation: Mozilla Foundation
            // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/random
            // Input/Parameters: Two floating point numbers, min and max
            // Output/Return: Returns a random integer between min and max
            function randomInt(min, max) 
            {
                min = Math.ceil(min);
                max = Math.floor(max);
                
                return Math.floor(Math.random() * (max - min + 1)) + min; 
            }
            // Description:
            // Citation:
            // Input/Parameters:
            // Output/Return:
            function formatImage(inputArray, index)
            {
                let fileName = inputArray[index];

                let output = "<img src='Monster Pics/" + fileName + " ' width=200 height=300>";
                
                return output;
            }
            // Description:
            // Citation:
            // Input/Parameters:
            // Output/Return:
            function viewInstructions()
            {
                divIdinstruct.innerHTML = "Full Instructions:" + "<br>" + 
                "Each player has a deck of monster cards. Each " + "<br>" +
                "round, a player will reveal a random card from their " + "<br>" +
                "deck. If the cards match, it is a 'Monster Match.'" + "<br>" +
                "The user will need to press 'Y' for yes or 'N' for " + "<br>" +
                "no, depending whether there is currently a match on" + "<br>" +
                "the board. If the user is correct, their score is" + "<br>" +
                "increased by 1. If they are incorrect, their score is " + "<br>" +
                "reduced by 1. You win the game once you reach a " + "<br>" +
                "score of 10! Press 'Space' to receive a new set of" + "<br>" +
                "cards once a valid guess is made."
            }
            // Description:
            // Citation:
            // Input/Parameters:
            // Output/Return:
            function displayScore()
            {
                p1CountId.innerHTML = "Cards Left: " + deckCards;
                p2CountId.innerHTML = "Cards Left: " + deckCards;
            }
            // Description:
            // Citation:
            // Input/Parameters:
            // Output/Return:
            function dealNewCards()
            {
                deckIndex1 = randomInt(0, p1Deck.length - 1);
                deckIndex2 = randomInt(0, p2Deck.length - 1);
                
                curCardP1 = formatImage(p1Deck, deckIndex1);
                curCardP2 = formatImage(p2Deck, deckIndex2);

                image1Id.innerHTML = curCardP1
                image2Id.innerHTML = curCardP2

                gameState = "Play"

                divIdinstruct.innerHTML = "Press 'Y' if matching or 'N' if not matching"
            }
            // Description:
            // Citation:
            // Input/Parameters:
            // Output/Return:
            function newGame()
            {
                for (i=0; i<=3; i++)
                {
                    p1Deck.push(imageArray[i])
                    p1Deck.push(imageArray[i])
                    p2Deck.push(imageArray[i])
                    p2Deck.push(imageArray[i])
                }

                player1Id.innerHTML = "Player 1"
                player2Id.innerHTML = "Player 2"

                dealNewCards();
                displayScore();
            }
            // Description:
            // Citation:
            // Input/Parameters:
            // Output/Return:
            function winGame()
            {
                if (score == 10)
                {
                    gameState = "Game Over"
                    divIdmessages.innerHTML = "Congratulations, you won! Press 'Start New Game' to play again"
                }
            }
            // Description:
            // Citation:
            // Input/Parameters:
            // Output/Return:
            function checkMatch(event)
            {
                pressKey = event.key
                if (gameState == "Play")
                {
                    if (pressKey == "y")
                    {
                        if (curCardP1 == curCardP2)
                        {
                            divIdmessages.innerHTML = "Congrats you got it correct! Press the Space key to deal more cards."
                            score++
                        }
                        else
                        {
                            divIdmessages.innerHTML = "Uh oh, you got it wrong! Press the Space key to deal more cards."
                            score--
                        }
                        gameState = "Pause"
                    }
                    else if (pressKey == "n")
                    {
                        if (curCardP1 != curCardP2)
                        {
                            divIdmessages.innerHTML = "Congrats you got it correct! Press the Space key to deal more cards."
                            score++
                        }
                        else
                        {
                            divIdmessages.innerHTML = "Uh oh, you got it wrong! Press the Space key to deal more cards."
                            score--
                        }
                        gameState = "Pause"
                    }
                    else 
                    {
                        divIdmessages.innerHTML = "Oops, you clicked an invalid key. Please press 'Y' if matching or 'N' if not matching"
                    }
                }
                else if (gameState == "Pause")
                {
                    if (pressKey == " ")
                    {
                        gameState = "Play"
                    }
                    winGame();
                    displayScore();
                }
            }
        </script>
    </head>
    <body onkeyup="checkMatch(event)">
        <h1>Monster Match</h1>
        <input type="button" value="Start New Game" onClick="newGame()">
        <input type="button" value="View Game Instructions" onClick="viewInstructions()">
        <table>
            <tr>
                <th><span id="player1Id"></span></th>
                <th><span id="player2Id"></span></th>
            </tr>
            <tr>
                <th><span id="image1Id"></span></th>
                <th><span id="image2Id"></span></th>
            </tr>
            <tr>
                <th><span id="p1CountId"></span></th>
                <th><span id="p2CountId"></span></th>
            </tr>
        </table>
        <div id="divIdmessages"></div>
        <div id="divIdinstruct"></div>
        <div id="divIdcurScore"></div>
    </body>
</html>